name: "Workflow Dispatch"
run-name: "Workflow Dispatch"

on:
  # schedule: 
  #   - cron: "* * * * *"

  workflow_dispatch:
    inputs:
      foo:
        default: bar
        type: string
        required: true
      bar:
        default: baz
        type: string
        required: false

jobs:
  # remote:
  #   uses: ./.github/workflows/workflow_call.yaml
  #   with:
  #     foo: ${{ inputs.foo || 'bar' }}
  #     bar: ${{ inputs.bar || 'bazzzzz' }}

  test:
    environment: staging
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
  
  run-if-accetp:
    needs: 
      - test
    runs-on: ubuntu-latest
    steps:
      - name: Checkout the repo
        uses: actions/checkout@v4

      - run: |
          echo "${{ needs.test.result }}"

      - env:
          GITHUB_TOKEN: ${{ github.token }}
          version: v1.0.4
        run: |
          echo "${{ needs.test.result }}"
          gh release view $version --json tagName -q .tagName

  run-if-cancel:
    if: ${{ ! cancelled() && needs.test.result != 'success' }}
    needs: 
      - test
    runs-on: ubuntu-latest
    steps:
      - name: Checkout the repo
        uses: actions/checkout@v4
        
      - run: |
          echo "${{ needs.test.result }}"

      - env:
          GITHUB_TOKEN: ${{ github.token }}
          version: v1.0.4
        run: |
          echo "${{ needs.test.result }}"
          gh release view $version --json tagName -q .tagName

